{% extends 'base.fcc.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('jquery-confirm/jquery-confirm.min.css') }}"/>
    <link href="{{ asset('bootstrap-datepicker-1.6.4-dist/css/bootstrap-datepicker.min.css') }}" rel="stylesheet">
    <link href="{{ asset('jasny-bootstrap-v3.1.3/css/jasny-bootstrap.min.css') }}" rel="stylesheet">
{% endblock %}

{% block page_toolbar_left %}
    Edit RecruitmentAdvert Upload
{% endblock %}
{% block page_toolbar_right %}
    <a class="btn btn-link close-btn" href="{{ path('mda_admin_vacancy_show', { selector : vacancy.selector }) }}"><i class="fa fa-arrow-left"></i></a>
{% endblock %}

{% block main %}
    <div class="row">
        <div class="col-sm-10">

            {% if alertNotification.hasMessage %}
                <div style="margin-bottom: 30px;">
                    <div class="alert alert-{{ alertNotification.type }} alert-dismissible" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                    aria-hidden="true">&times;</span></button>
                        {% for message in alertNotification.messages %}
                            {{ message }}
                        {% endfor %}
                    </div>
                </div>
            {% endif %}

            <form id="main-form" method="post" action="{{ path('mda_admin_vacancy_edit', { selector : vacancy.selector }) }}" class="form-horizontal"
                  enctype="multipart/form-data" onsubmit="showLoading();">
                <div class="form-group">
                    <label for="title" class="col-sm-2 control-label text-bold">Title:<span class="required"> *</span></label>
                    <div class="col-sm-10">
                        <textarea type="text" name="title"
                                  class="form-control input-14" id="title" placeholder="Enter Title"
                                  autocomplete="off">{{ vacancy.title }}</textarea>
                        {{ validator.fields.field('title').html | raw }}
                    </div>
                </div>

                <div class="form-group">
                    <label for="start-date" class="col-sm-2 control-label text-bold">Start Date:<span class="required"> *</span></label>
                    <div class="col-sm-10">
                        <input type="text" name="start_date"  value="{{ vacancy.startDate }}" style="width: 360px;"
                               class="form-control input-14" id="start-date" placeholder="Enter Start Date"
                               autocomplete="off" readonly>
                        {{ validator.fields.field('start_date').html | raw }}
                    </div>
                </div>

                <div class="form-group">
                    <label for="end-date" class="col-sm-2 control-label text-bold">End Date:<span class="required"> *</span></label>
                    <div class="col-sm-10">
                        <input type="text" name="end_date"  value="{{ vacancy.endDate }}" style="width: 360px;"
                               class="form-control input-14" id="end-date" placeholder="Enter End Date"
                               autocomplete="off" readonly>
                        {{ validator.fields.field('end_date').html | raw }}
                    </div>
                </div>

                <div class="form-group">
                    <label for="post" class="col-sm-2 control-label text-bold">RecruitmentAdvert Details:<span class="required"> *</span></label>
                    <div class="col-sm-10">
                        <textarea class="form-control input-14 counter message" rows="6" name="post" id="is-rich-text"
                                  placeholder="Enter Post" maxlength="220">{{ vacancy.vacancyPost }}</textarea>
                        {{ validator.fields.field('post').html | raw }}
                    </div>
                </div>

                <div class="form-group">
                    <label for="vacancy_file" class="control-label col-sm-2 text-bold">
                        Attach Evidence Of Advert:
                        <span class="required"> </span>
                        <span class="help-block">(Optional)</span>
                    </label>

                    <div class="col-sm-10">
                        <div id="vacancy_file-error" class="validation-error"></div>

                        <div id="uploaded-file" class="fileinput fileinput-new" data-provides="fileinput">
                            <div class="fileinput-preview thumbnail" data-trigger="fileinput" style="width: 200px; height: 150px;"></div>
                            <div>
                                <span class="btn btn-info btn-sm btn-file">
                                    <span class="fileinput-new"><i class="fa fa-paperclip"></i> Select File</span>
                                    <span class="fileinput-exists"><i class="fa fa-edit"></i> Change</span>
                                    <input type="file" name="vacancy_file" id="vacancy_file" onchange="get_detail();"></span>
                                <a href="#" class="btn btn-danger btn-sm fileinput-exists" data-dismiss="fileinput">
                                    Remove <i class="fa fa-trash"></i>
                                </a>
                            </div>
                        </div>
                        <div id="file_error" class="validation-error"></div>
                        {{ validator.fields.field('vacancy_file').html | raw }}
                    </div>
                </div>

                <div class="col-sm-10 col-sm-offset-2">
                    <input type="hidden" name="submit_check"/>
                    <input type="hidden" name="old_document_file_name" value="{{ vacancy.uploadedFileName }}"/>
                    <input type="hidden" name="selector" value="{{ vacancy.selector }}">
                    <button type="submit" name="btn_submit" class="btn btn-primary">Submit</button>
                </div>

                <div class="v-sep-20"></div>
                <div class="v-sep-20"></div>
            </form>
        </div>
        <div class="col-sm-2">

        </div>
    </div>
{% endblock %}

{% block javascripts %}

    <script src="{{ asset('jasny-bootstrap-v3.1.3/js/jasny-bootstrap.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('js/jquery.form.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('jquery-confirm/jquery-confirm.min.js') }}"></script>
    <script src="{{ asset('bootstrap-datepicker-1.6.4-dist/js/bootstrap-datepicker.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('tinymce_4.5.3/tinymce/js/tinymce/tinymce.min.js') }}"></script>

    <script type="text/javascript">
        $(document).ready(function () {

            $('#start-date').datepicker(
                    {
                        autoclose: true,
                        format: 'dd/mm/yyyy',F
                        startDate: '01/05/2017'
                    }
            );

            $('#end-date').datepicker(
                    {
                        autoclose: true,
                        format: 'dd/mm/yyyy',
                        startDate: '01/05/2017'
                    }
            );

            tinymce.init({
                selector: 'textarea#is-rich-text',
                height: 340,
                menubar: false,
                plugins: [
                    'lists','table'
                ],
                toolbar: 'undo redo | styleselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | table'
            });

            var fileUpload = $('#vacancy_file');
            var fileError = $('#file_error');
            $('#main-form').on('submit', function (e) {

                var fileName = fileUpload.val();

                if(!fileName){
                    //do nothing
                    /*fileError.html('Please Select Attachment');
                    return false;*/
                }else{

                    var size= fileUpload[0].files[0].size;
                    var extension= fileName.replace(/^.*\./, '');

                    if($.inArray(extension, ['png','jpg','jpeg']) === -1){
                        fileError.html('Only images (png,jpg,jpeg) allowed');
                        return false;
                    }

                    if(size > 800000){
                        fileError.html('Invalid file Size. Not greater than 800kb');
                        return false;
                    }
                }

                showLoading();
                return true;

            });

        });
    </script>

{% endblock %}